# 进程，线程，协程

## 进程

```python
from multiprocessing import Pool
pool = Pool(5) #必须在if __name__ == '_main__':下运行
pool.map(fun, [...])
pool.close() #关闭进程池
pool.join()#启动进程并且block

from  concurrent.futures import ProcessPoolExecutor
with ProcessPoolExecutor(max_workers=5) as executor: #必须在if __name__ == '_main__':下运行
    while flag:
        round_ += 1
        futures = [executor.submit(map_main, cik) for cik in [...]] #提交任务并执行，block
        results = [future.result() for future in futures]  #获取返回的结果

```

## 线程

```python
from  concurrent.futures import ProcessPoolExecutor
with ThreadPoolExecutor(max_workers=5) as executor: #必须在if __name__ == '_main__':下运行
    while flag:
        round_ += 1
        futures = [executor.submit(map_main, cik) for cik in [...]] #提交任务并执行，block
        results = [future.result() for future in futures]  #获取返回的结果
```

## 协程

协程类似于进程，但是比进程开销小

```python
from gevent import monkey; monkey.patch_all() #必须写在文件第一行上
import gevent
import warnings
warnings.filterwarnings("ignore") #忽略gevent中的warning


while len(wanted):
    round_ += 1
    futures = [gevent.spawn(map_main, cik) for cik in wanted] #提交协程
    gevent.joinall(futures) #启动协程，并block
    results = [future.value for future in futures] #获取返回的结果
```

